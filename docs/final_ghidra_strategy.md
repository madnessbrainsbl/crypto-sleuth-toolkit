# üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞ SECRET_KEY

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ Ghidra

–ù–∞ –æ—Å–Ω–æ–≤–µ –¥–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ `FUN_00103994`, —Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —ç—Ç–∏—Ö –∞–¥—Ä–µ—Å–∞—Ö:

### üîê –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:
- **0x0010d54c** - crypto_handler_1 (case 3, bVar4 == true)
- **0x0010d5c4** - crypto_handler_2 (case 3, bVar4 == false)  
- **0x00109ac4** - crypto_handler_3 (other cases, bVar4 == true)
- **0x0010d8e4** - crypto_handler_4 (other cases, bVar4 == false)

## –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### 1. –í Ghidra - –¥–µ–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
```
Ghidra ‚Üí Window ‚Üí Functions
–ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- FUN_0010d54c
- FUN_0010d5c4  
- FUN_00109ac4
- FUN_0010d8e4
```

**–ò—â–∏—Ç–µ –≤ –Ω–∏—Ö:**
- –°—Ç—Ä–æ–∫–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- –í—ã–∑–æ–≤—ã HMAC —Ñ—É–Ω–∫—Ü–∏–π
- –ë—É—Ñ–µ—Ä—ã —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –û–±—Ä–∞—â–µ–Ω–∏—è –∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º

### 2. –ê–Ω–∞–ª–∏–∑ –±—É—Ñ–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏:
- **+0x5db4** - –æ—Å–Ω–æ–≤–Ω–æ–π –±—É—Ñ–µ—Ä –¥–∞–Ω–Ω—ã—Ö
- **+0x142c** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –±—É—Ñ–µ—Ä
- **+0x5430** - –±—É—Ñ–µ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 0x800 –±–∞–π—Ç
- **+0x5c90** - —Ñ–ª–∞–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–≤–∞–∂–µ–Ω –¥–ª—è case 3!)

### 3. –ü–æ–∏—Å–∫ –≤—ã–∑–æ–≤–æ–≤ FUN_00103994
```
Ghidra ‚Üí Search ‚Üí For Scalars
–ü–æ–∏—Å–∫: 0x00103994
```
–ù–∞–π–¥–∏—Ç–µ –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏ –ø—Ä–æ—Å–ª–µ–¥–∏—Ç–µ:
- –û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ö–∞–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –±—É—Ñ–µ—Ä param_2
- –°–≤—è–∑—å —Å JWT –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

### 4. GDB –∞–Ω–∞–ª–∏–∑ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±—É—Ñ–µ—Ä–æ–≤:
```bash
gdb ./unlock
(gdb) set args [—Ä–∞–±–æ—á–∏–π_—Ç–æ–∫–µ–Ω]
(gdb) break *0x00103994
(gdb) run

# –ö–æ–≥–¥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏:
(gdb) x/32x $rdi+0x5db4  # –û—Å–Ω–æ–≤–Ω–æ–π –±—É—Ñ–µ—Ä
(gdb) x/32x $rdi+0x142c  # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –±—É—Ñ–µ—Ä 
(gdb) x/128x $rdi+0x5430 # –ë–æ–ª—å—à–æ–π –±—É—Ñ–µ—Ä
(gdb) info registers      # –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
```

#### Breakpoint-—ã –Ω–∞ –∫—Ä–∏–ø—Ç–æ—Ñ—É–Ω–∫—Ü–∏–∏:
```bash
(gdb) break *0x0010d54c
(gdb) break *0x0010d5c4
(gdb) break *0x00109ac4
(gdb) break *0x0010d8e4
(gdb) continue
```

–ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ –ª—é–±–æ–π –∏–∑ –Ω–∏—Ö:
```bash
(gdb) bt                 # –°—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤
(gdb) info args          # –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
(gdb) x/64s $rdi         # –°—Ç—Ä–æ–∫–∏ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏
```

### 5. –ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫ —Ä—è–¥–æ–º —Å –∫—Ä–∏–ø—Ç–æ—Ñ—É–Ω–∫—Ü–∏—è–º–∏

```bash
# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –∏–∑ –æ–±–ª–∞—Å—Ç–µ–π –≤–æ–∫—Ä—É–≥ —Ñ—É–Ω–∫—Ü–∏–π
objdump -s -j .rodata unlock | grep -A5 -B5 "10d5"
objdump -s -j .data unlock | grep -A5 -B5 "10d5"

# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ –≤ –±–∏–Ω–∞—Ä–Ω–∏–∫–µ
strings -n 8 unlock | grep -E "(key|secret|hmac|jwt|cunba|unlock)"
```

### 6. –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏

–≠—Ç–∏ –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é –∫–ª—é—á–∞:
- `0x20000f` - –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞
- `0x3fff` - 14-–±–∏—Ç–Ω–∞—è –º–∞—Å–∫–∞  
- `0x3ffff` - 18-–±–∏—Ç–Ω–∞—è –º–∞—Å–∫–∞
- `0x800` - —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞
- `0xffffffffffffff89` - –≥—Ä–∞–Ω–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

### 7. –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è QNX

–ü–æ—Å–∫–æ–ª—å–∫—É –º–∞—à–∏–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `getprop`, –∫–ª—é—á –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç:
```bash
# –ù–∞ QNX —Å–∏—Å—Ç–µ–º–µ:
getprop | grep -E "(serial|id|hardware|build)"
cat /proc/cpuinfo
cat /proc/version
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∫–ª—é—á–µ–π

–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞, SECRET_KEY –º–æ–∂–µ—Ç –±—ã—Ç—å:

1. **–•–∞—Ä–¥–∫–æ–¥ –≤ –æ–¥–Ω–æ–π –∏–∑ –∫—Ä–∏–ø—Ç–æ—Ñ—É–Ω–∫—Ü–∏–π**
2. **–ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: `—Å–µ—Ä–∏–π–Ω—ã–π_–Ω–æ–º–µ—Ä + "CunBA" + magic_constant`
3. **XOR —Ä–µ–∑—É–ª—å—Ç–∞—Ç** –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
4. **MD5/SHA256** –æ—Ç vehicle_id –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –¥–∞–Ω–Ω—ã—Ö
5. **–ë—É—Ñ–µ—Ä –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É** –≤ –ø–∞–º—è—Ç–∏

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ

**Case 3** –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å–æ–±–µ–Ω–Ω—ã–π - —Ç–∞–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `*(int *)(param_1 + 0x5c90) == 0`

–≠—Ç–æ—Ç —Ñ–ª–∞–≥ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ JWT!
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ breakpoint –∏–º–µ–Ω–Ω–æ –Ω–∞ case 3 –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### Ghidra –∫–æ–º–∞–Ω–¥—ã:
- `Window ‚Üí Functions` - —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π
- `Search ‚Üí For Scalars` - –ø–æ–∏—Å–∫ –∞–¥—Ä–µ—Å–æ–≤
- `Search ‚Üí For Strings` - –ø–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫
- `Window ‚Üí Defined Strings` - –≤—Å–µ —Å—Ç—Ä–æ–∫–∏

### GDB –∫–æ–º–∞–Ω–¥—ã:
- `x/Nx addr` - –¥–∞–º–ø –ø–∞–º—è—Ç–∏ (N = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, x = hex)
- `x/Ns addr` - —Å—Ç—Ä–æ–∫–∏
- `info registers` - —Ä–µ–≥–∏—Å—Ç—Ä—ã
- `bt` - —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤
- `watch addr` - –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –∞–¥—Ä–µ—Å–æ–º

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
- `hexdump -C unlock | grep -A2 -B2 "—Å—Ç—Ä–æ–∫–∞"`
- `objdump -d unlock | grep -A10 -B5 "–∞–¥—Ä–µ—Å_—Ñ—É–Ω–∫—Ü–∏–∏"`
- `readelf -a unlock` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ELF

–£—Å–ø–µ—Ö–æ–≤ –≤ –ø–æ–∏—Å–∫–µ! üîç
